{"version":3,"sources":["core.js","Table.js","RecordsTable.js","RulesTable.js"],"names":["window","RESTCache","extend","child","parent","constructor","prototype","Object","create","jQuery","$","tabs","Table","element","self","this","$element","url","attr","on","event","onEdit","onUpdate","onDelete","getIDFromEvent","currentTarget","closest","getControlFromField","field","$input","setItemEditable","id","$tr","find","children","each","index","td","val","text","empty","append","addClass","data","el","ajax","method","success","response","status","xhr","onActionComplete","DataTable","reload","RecordsTable","call","recordsTable","RulesTable","onAddRule","rulesTable"],"mappings":"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","file":"main.js","sourcesContent":["window.RESTCache = {\r\n\textend: function(child, parent) {\r\n\t\t\r\n\t\tvar constructor = child;\r\n\t\t\r\n\t\tchild.prototype = Object.create(parent.prototype);\r\n\t\tchild.prototype.constructor = constructor;\r\n\t\t\r\n\t}\r\n};\r\n\r\njQuery(function($) {\r\n\t\r\n\t$(\"#rest-cache-tabs\").tabs();\r\n\t\r\n});","// requires: core.js\r\n\r\njQuery(function($) {\r\n\t\r\n\tRESTCache.Table = function(element)\r\n\t{\r\n\t\tvar self = this;\r\n\t\t\r\n\t\tthis.$element = $(element);\r\n\t\t\r\n\t\tthis.url = this.$element.attr(\"data-route\");\r\n\t\t\r\n\t\tthis.$element.on(\"click\", \"[data-action='edit']\", function(event) {\r\n\t\t\tself.onEdit(event);\r\n\t\t});\r\n\t\t\r\n\t\tthis.$element.on(\"click\", \"[data-action='update']\", function(event) {\r\n\t\t\tself.onUpdate(event);\r\n\t\t});\r\n\t\t\r\n\t\tthis.$element.on(\"click\", \"[data-action='delete']\", function(event) {\r\n\t\t\tself.onDelete(event);\r\n\t\t});\r\n\t}\r\n\t\r\n\tRESTCache.Table.prototype.getIDFromEvent = function(event)\r\n\t{\r\n\t\tvar $tr = $(event.currentTarget).closest(\"tr\");\r\n\t\tvar id = $tr.attr(\"data-id\");\r\n\t\t\r\n\t\treturn id;\r\n\t}\r\n\t\r\n\tRESTCache.Table.prototype.getControlFromField = function(field)\r\n\t{\r\n\t\tvar $input = $(\"<input/>\");\r\n\t\t$input.attr(\"name\", field);\r\n\t\treturn $input;\r\n\t}\r\n\t\r\n\tRESTCache.Table.prototype.setItemEditable = function(id)\r\n\t{\r\n\t\tvar self = this;\r\n\t\tvar $tr = this.$element.find(\"tr[data-id='\" + id + \"']\");\r\n\t\t\r\n\t\t$tr.children(\"td\").each(function(index, td) {\r\n\t\t\t\r\n\t\t\tvar field = $(td).attr(\"data-field\");\r\n\t\t\t\r\n\t\t\tswitch(field)\r\n\t\t\t{\r\n\t\t\t\tcase \"id\":\r\n\t\t\t\tcase \"actions\":\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\tvar $input = self.getControlFromField(field);\r\n\t\t\t\r\n\t\t\t$input.val($(td).text());\r\n\t\t\t\r\n\t\t\t$(td).empty();\r\n\t\t\t$(td).append($input);\r\n\t\t\t\r\n\t\t});\r\n\t\t\r\n\t\t$tr.addClass(\"rest-cache-editing\");\r\n\t}\r\n\t\r\n\tRESTCache.Table.prototype.onEdit = function(event)\r\n\t{\r\n\t\tvar id = this.getIDFromEvent(event);\r\n\t\tthis.setItemEditable(id);\r\n\t}\r\n\t\r\n\tRESTCache.Table.prototype.onUpdate = function(event)\r\n\t{\r\n\t\tvar self\t= this;\r\n\t\tvar id\t\t= this.getIDFromEvent(event);\r\n\t\tvar data\t= {};\r\n\t\tvar $tr\t\t= $(event.currentTarget).closest(\"tr\");\r\n\t\t\r\n\t\t$tr.find(\":input\").each(function(index, el) {\r\n\t\t\t\r\n\t\t\tif(!$(el).attr(\"name\"))\r\n\t\t\t\treturn;\r\n\t\t\t\r\n\t\t\tdata[$(el).attr(\"name\")] = $(el).val();\r\n\t\t\t\r\n\t\t});\r\n\t\t\r\n\t\t$.ajax(this.url + \"/\" + id, {\r\n\t\t\tmethod: \"PUT\",\r\n\t\t\tdata: data,\r\n\t\t\tsuccess: function(response, status, xhr) {\r\n\t\t\t\tself.onActionComplete(response);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\tRESTCache.Table.prototype.onDelete = function(event)\r\n\t{\r\n\t\tvar self\t= this;\r\n\t\tvar id\t\t= this.getIDFromEvent(event);\r\n\t\t\r\n\t\t$.ajax(this.url + \"/\" + id, {\r\n\t\t\tmethod: \"DELETE\",\r\n\t\t\tsuccess: function(response, status, xhr) {\r\n\t\t\t\tself.onActionComplete(response);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\tRESTCache.Table.prototype.onActionComplete = function(event)\r\n\t{\r\n\t\tthis.$element.DataTable().ajax.reload();\r\n\t}\r\n\t\r\n});","// requires: Table.js\r\n\r\njQuery(function($) {\r\n\t\r\n\tRESTCache.RecordsTable = function(element)\r\n\t{\r\n\t\tRESTCache.Table.call(this, element);\r\n\t}\r\n\t\r\n\tRESTCache.extend(RESTCache.RecordsTable, RESTCache.Table);\r\n\t\r\n\t$(window).on(\"load\", function(event) {\r\n\t\t\r\n\t\tRESTCache.recordsTable = new RESTCache.RecordsTable($(\"#records table[data-route]\"));\r\n\t\t\r\n\t});\r\n\t\r\n});","// requires: Table.js\r\n\r\njQuery(function($) {\r\n\t\r\n\tRESTCache.RulesTable = function(element)\r\n\t{\r\n\t\tvar self = this;\r\n\t\t\r\n\t\tRESTCache.Table.call(this, element);\r\n\t\t\r\n\t\t$(\"button#add-rule\").on(\"click\", function(event) {\r\n\t\t\tself.onAddRule(event);\r\n\t\t});\r\n\t}\r\n\t\r\n\tRESTCache.extend(RESTCache.RulesTable, RESTCache.Table);\r\n\t\r\n\tRESTCache.RulesTable.prototype.onAddRule = function(event)\r\n\t{\r\n\t\tvar self = this;\r\n\t\t\r\n\t\t$.ajax(this.url, {\r\n\t\t\tmethod: \"POST\",\r\n\t\t\tsuccess: function(response, status, xhr) {\r\n\t\t\t\tself.$element.DataTable().ajax.reload();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\t$(window).on(\"load\", function(event) {\r\n\t\t\r\n\t\tRESTCache.rulesTable = new RESTCache.RulesTable($(\"#rules table[data-route]\"));\r\n\t\t\r\n\t});\r\n\t\r\n});"]}